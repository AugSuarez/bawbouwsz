<!DOCTYPE html>
<!-- leave just Name priority and subtasks, and add a more button, which shows due date, other description -->
<head>
<!-- <?php

?> -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="stylesheet.css">
<script src="js/jquery.min.js"></script>
</head>
<html>
<body>
<div class="title">BAWBOUWSZ</div>
<nav>
	<div class="score">0</div>
	<!-- <div class="score-bubble"></div> -->
	<div class="target">0</div>
	<button type="button" class="stop-btn">
		STOP
	</button>
	<button type="button" class="new-game-btn">
		NEW GAME
	</button>
	<div class="time-left">10</div>
</nav>

<div class="game-container">
	<div class="game">
		<div class="stop-screen" style="display:none"></div>
		<div class="lose-screen" style="display:none"><p>YU WOOZ BITCH!</p></div>
	</div>
</div>
</body>

	<script type="text/javascript">	
	$(function(){

		$(".target").html(Math.floor(Math.random() * 100));

		function bubbleType(){
			var x = Math.floor(Math.random() * 8);
			switch(x){
				case 0:
					var color_dims = 'background-color: #B3FF61; height: ' + 1.8 + 'em; width:' + 1.8 + 'em;"';
					var value = parseInt(1);
				break;
				case 1: 
					var color_dims = 'background-color: #3DE840; height: ' + 2.2 + 'em; width:' + 2.2 + 'em;"';
					var value = parseInt(2);
				break;
				case 2: 
					var color_dims = 'background-color: #18FF81; height: ' + 2.8 + 'em; width:' + 2.8 + 'em;"';
					var value = parseInt(5);
				break;
				case 3: 
					var color_dims = 'background-color: #41E8D6; height: ' + 3.2 + 'em; width:' + 3.2 + 'em;"';
					var value = parseInt(10);
				break;
				case 4: 
					var color_dims = 'background-color: #358EFF; height: ' + 4 + 'em; width:' + 4 + 'em;"';
					var value = parseInt(20);
				break;
				case 5: 
					var color_dims = 'background-color: #113747; height: ' + 2.4 + 'em; width:' + 2.4 + 'em;"';
					var value = parseInt(-5);
				break;
				case 6: 
					var color_dims = 'background-color: #0E302D; height: ' + 3.2 + 'em; width:' + 3.2 + 'em;"';
					var value = parseInt(-10);
				break;
				case 7: 
					var color_dims = 'background-color: #113747; height: ' + 4 + 'em; width:' + 4 + 'em;"';
					var value = parseInt(-20);
				break;
			}

			var sign;

			if(value > 0) {
				sign = "+";
			}
			else
				sign = "";

			return [color_dims, value, sign];
		}

		function margin(){return Math.floor(Math.random() * 100) + "%"};

		var createdBubbles = 0;
		var bubbleCount = 0;

		function newBubble(){
			bubble_type = bubbleType();
			var bubble = '<div class="bubble" style="top:' + margin() + '; left:' + margin() + ';' + bubble_type[0] + ' " id=' + createdBubbles + '" data-count=' + bubble_type[1] + '><p>' + bubble_type[2] + bubble_type[1] + '</p></div>';
			$(".game").append(bubble);
			createdBubbles++;
			bubbleCount++;
		}		

		var timer = setInterval(function(){	
			if (createdBubbles < 6) {
				newBubble();
			}
			else
				clearInterval(timer);
		}, 50);

		function newPosition(){
			var h = $('.game').height()+500;
			var w = $('.game').width();

			var newHeight = Math.floor(Math.random() * h);
			var newWidth = Math.floor(Math.random() * w);

			return [newHeight, newWidth];
		}

		function moveBubbles(span = 5000){
				$('.bubble').each(function(index){
					var trajectory = newPosition();
					$(this).animate({top: trajectory[0], left: trajectory[1]}, span, "linear")
				});
				return true;
		}

		function bubbleTimer(repeat){
			t = setInterval(function(){
					newBubble(); 
					moveBubbles();
					if(createdBubbles > 50) {clearInterval(generatorTimer)}
				}, repeat);
			return t;
		}

		function secondsTimer(){
			t = setInterval(function(){
				$('.score').html(parseInt($('.score').html()) + parseInt(1));
			}, 1000);
			return t;
		}

		increment = secondsTimer();

		countDown = setInterval(function() {$('.time-left').html(parseInt($('.time-left').html()) - parseInt(1));}, 1000);

		var generatorTimer = bubbleTimer(1000);

			$(".game").on('mouseover', '.bubble', function(){

			$(this).remove();
			bubbleCount--;
			$('.bubble').each(function(index){$(this).stop()});

			score = parseInt($('.score').html());
			score += parseInt($(this).attr('data-count'));
			$(".score").html(score);

			if($(".score").html() == $(".target").html()){//SWWWEEEET SWEEETTTTT VICTORY!!!
				$('.bubble').each(function(index){$(this).stop()});
				clearInterval(generatorTimer);
				clearInterval(increment);
				clearInterval(countDown);
				var winDiv = $('<button type="button" class ="win">YOU WIN!</button>');
				$('.game-container').append(winDiv);
				$('.bubble').fadeOut(10, function(){$(this).remove();});
			}

			else if(createdBubbles <= 50) {
				newBubble();
			}

			else if(bubbleCount == 0){//LOOOOOOSSSEEEEEERRRR
				$('.lose-screen').css('display',  "block");
				$('.stop-btn').prop('disabled', 'disabled');
			}

			if($(".score").html() != $(".target").html()){
				moveBubbles();
			}
		});

		$('nav').on('click', '.stop-btn', function(){
			$('.bubble').each(function(index){$(this).stop();});
			clearInterval(generatorTimer);
			clearInterval(increment);
			clearInterval(countDown);
			if ($('.stop-screen').css('display') == "none") {
				$('.stop-screen').css('display',  "block");
				$('.stop-btn').html("Resume");
			}
			else {
				generatorTimer = bubbleTimer(1000);
				increment = secondsTimer();
				countDown = setInterval(function() {$('.time-left').html(parseInt($('.time-left').html()) - parseInt(1));}, 1000);
				$('.stop-screen').css('display', "none");
				$('.stop-btn').html("stop");
			}
		});

		$('.game-container').on('click', '.win', function(){location.reload()});
		$('nav').on('click', '.new-game-btn', function(){location.reload()});
		
	});
	</script>
</html>
